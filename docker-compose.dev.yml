# Development docker-compose - builds images locally
version: '3.8'

services:
  webserver:
    build: .
    command: ["./kboard-cli", "start", "--environment", "development", "--all"]
    environment:
      - JWT_SECRET_KEY=${JWT_SECRET_KEY}
      - MAIL_APP_PWD=${MAIL_APP_PWD}
    volumes:
      - webserver_data:/data
    networks:
      - kboard_network
    tty: false
    stdin_open: false

  nginx:
    build: nginx/
    volumes:
      - ./nginx/nginx.dev.conf:/etc/nginx/nginx.conf:ro
    ports:
      - "80:80"
    depends_on:
      - webserver
    networks:
      - kboard_network

volumes:
  webserver_data:

networks:
  kboard_network:
    driver: bridge